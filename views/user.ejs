<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Fitness Tracker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet"  type="text/css" href="style.css" />
  </head>
  <body>
    <header>
      <h1>Fitness Tracker</h1>
      <nav>
        <a href="../login">Logout</a>
      </nav>  
    </header>

    <section class="home-container">
      <h1>User dashboard</h2>

      <h2>Logs: </h3>

      <form method="POST" action="add-log">
        <p>Title: <input id="title" type="text" name="title" /></p>
      <input type="submit" value="Add" />

      <h2>Your logs: </h3>
      
      <% logs.forEach(log => { %>
        <div>
          <button class="log-button" data-log-id="<%= log.id %>">button<%= log.id %></button>
        </div>
      <% }) %>

      <script>
        document.querySelectorAll('.log-button').forEach(button => {
          button.addEventListener('click', async () => {
            const logId = button.dataset.logId;
            
            try {
              const response = await fetch('./api/post', {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                  logId: logId,
                  message: 'Hello from the client!',
                  timestamp: new Date().toISOString()
                })
              });

              const data = await response.json();
              console.log('Success:', data);
              alert('Request sent successfully!');
            } catch (error) {
              console.error('Error:', error);
              alert('Request failed!');
            }
          });
        });
      </script>

    </section>
  </body>
</html>
